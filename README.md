## Аннотация
Биржа обеспечивает функционирование рынка ценных бумаг для проведения регулярных торгов, которые необходимо фиксировать. 

С этой целью была разработана программа, позволяющая накапливать и анализировать данные торгов срочного рынка. Она эффективно справляется с большим объемом информации, что упрощает работу с ценными бумаги.

## Содержание
0. [Введение](#введение)  

1. [Техническое задание на разработку](#техническое-задание-на-разработку)

2. [Проект информационной системы](#проект-информационной-системы)  

    2.1. [Описание функций и функциональные спецификации](#описание-функций-и-функциональные-спецификации)  
 
    2.2. [Описание информационной структуры](#описание-информационной-структуры)  
    
    2.3. [Описание модульной структуры](#описание-модульной-структуры)  
    
3. [Документация информационной системы](#документация-информационной-системы)  

    3.1. [Краткое описание и назначение системы](#краткое-описание-и-назначение-системы)  
    
    3.2. [Руководство пользователя](#руководство-пользователя)  
    
    3.3. [Руководство администратора](#руководство-администратора)  
    
4. [Результаты испытания системы](#результаты-испытаний-системы)  

5. [Заключение](#заключение)

6. [Список использованных источников](#список-используемых-источников)


## Введение
Разработанная программа обеспечивает визуализацию данных о торгах ценными бумагами в виде таблиц, а также взаимодействие с данными, что включает в себя расчет статистических характеристик и однодневной процентной ставки, изменение исходных данных и формирование документов.

Программа интуитивно понятна и проста для освоения. Все правила работы с ней подробно описаны в руководстве пользователя. Использование данной программы значительно упрощает работу в сфере биржевых торгов.

## Техническое задание на разработку
**Объект, для которого выполняется разработка:** биржа, осуществляющая операции с ценными бумагами.

**Цель работы:** создание программных средств для накопления и анализа данных торгов активами срочного рынка.

**Требования к функциям, реализуемым в программах анализа данных:**

а) контроль и восстановление целостности баз данных системы;

б)  добавление в базу данных информации по одному или нескольким торговым дням, удаление и корректировка информации, верификация вновь поступивших данных, обеспечение целостности данных;

в) просмотр информации о торгах активами срочного рынка, фильтрация и упорядочивание информации при просмотре; 

г) расчет по каждому выпуску ценных бумаг G<sub>k</sub> в каждый торговый день t<sub>i</sub> основного контролируемого показателя - однодневной процентной ставки

x<sub>k</sub>(i) = ln{ F<sub>k</sub>(i) / 100)}/( T<sub>k</sub>) - t<sub>i</sub>),
где i - порядковый номер торгового дня;

д) для выбираемой пользователем даты t должны быть рассчитаны по предшествующим торгам на заданной календарной предыстории основные статистические характеристики (x<sub>kср</sub>, &sigma;<sub>k</sub><sup>2</sup>) для показателей x<sub>k</sub> для всех выпусков ценных бумаг, продававшихся в день t (если какая-то бумага продавалась не на всех торгах заданной предыстории, то расчет должен быть сделан по фактически проведенным торгам); 

е) по той же предыстории необходимо определить, менялись ли среднее значение и дисперсия показателей и, если да, то какова тенденция изменения в день t (растет, уменьшается);

ж) для выбранной даты t для ценной бумаги, участвовавшей на наибольшем числе торгов, оценить параметры смеси двух нормальных распределений;

з) обеспечить визуализацию данных торгов и расчетов, формирование документов.

## Проект информационной системы  
### Описание функций и функциональные спецификации
- **Отображение**

    Осуществляется через главное окно с возможностью переключения между таблицами.    

- **Упорядочивание**

    Осуществляется через главное окно при нажатии на заголовок соответствующего столбца таблицы. Столбец сортируется в лексико-графическом порядке.  

- **Фильтрация**

    Осуществляется через главное окно по введенным значениям полей: дата торгов, код бумаги, цена и доходность. После ввода нажатием на кнопку «Применить фильтр» отображается таблица с учетом примененных фильтров. Доступно использование различных комбинаций введенных значений, при этом целостность данных сохраняется. Для возврата к исходному состоянию необходимо нажать на кнопку «Сбросить фильтр».  

- **Удаление**

    Осуществляется через главное окно нажатием на кнопку «Удалить запись». Перед этим необходимо выбрать одну или несколько записей для удаления. Если запись не выбрана, появится сообщение об ошибке. Для завершения пользователю необходимо подтвердить удаление нажатием на кнопку «Ок» в диалоговом окне.

- **Добавление в таблицу Activ**

    Осуществляется в отдельном диалоговом окне после нажатия на кнопку «Добавить запись» на главном окне при условии, что эта таблица открыта в данный момент. Для завершения добавления пользователю необходимо выбрать дату торгов из календаря, код бумаги из выпадающего списка и ввести текущую цену и текущую доходность. Если ввод произведен корректно, после нажатия на кнопку «Ок» в таблице Activ появится новая запись.

- **Добавление в таблицу act_isp**

    Осуществляется в отдельном диалоговом окне после нажатия на кнопку «Добавить запись» на главном окне, при условии, что эта таблица выбрана в данный момент. Для завершения добавления пользователю необходимо ввести код бумаги и выбрать дату погашения из календаря. Если ввод произведен корректно, после нажатия на кнопку «Ок» в таблице act_isp появится новая запись.

- **Редактирование**

    Осуществляется в отдельном диалоговом окне после нажатия на кнопку «Редактировать запись» на главном окне. Перед этим необходимо выбрать одну запись для редактирования. Если запись не выбрана, появится сообщение об ошибке. Для завершения редактирования пользователю необходимо ввести новое значение для текущей цены и текущей доходности. Если ввод произведен корректно, после нажатия на кнопку «Ок» в соответствующую запись таблицы внесутся изменения.

- **Расчет ставки**

    Осуществляется после успешного редактирования или добавления. При последующем применении редактирования и добавления автоматически пересчитывается соответствующее значение ставки.

- **Анализ статических характеристик**

    Осуществляется в отдельном диалоговом окне после нажатия на кнопку «Анализ ставки» на главном окне. Пользователю предоставляется выбрать дату из календаря начала и конца предыстории. Если даты введены корректно, то при нажатии на кнопку «Рассчитать» в таблице отображаются рассчитанные среднее и дисперсия для каждого кода бумаги выбранного дня t, тенденция изменения среднего и дисперсии по сравнению с днем t-1, а также размах. Нажатием на кнопку «Очистить» данные из таблицы стираются, а при нажатии на кнопку «Сохранить» создается документ, в котором фиксируется текущее состояние таблицы.

- **Сохранение**

    Осуществляется через главное окно нажатием на кнопку «Сохранить». Созданный документ doc1.dox содержит таблицу данных с учетом примененной фильтров. Помимо самой таблицы в документе также указываются фильтры, по которым была применена фильтрация.

### Описание информационной структуры
Информационная структура образуется двумя таблицами Activ и Act_isp. Эти таблицы имеют связь «1 к многим» по полю regnum. 
 
Таблица Activ:
| Ключ | Имя столбца | Тип данных | Описание                           |
|------|-------------|------------|------------------------------------|
| 🔑    | torg_date   | TEXT       | Даты торгов ценными бумагами       |
| 🔑    | regnum      | TEXT       | Коды ценных бумаг                  |
|      | price       | REAL       | Значения текущей цены ценных бумаг |
|      | gain_end    | REAL       | Значения текущей доходности        |

Таблица Act_isp:

| Ключ | Имя столбца | Тип данных | Описание                    |
|------|-------------|------------|-----------------------------|
| 🔑    | regnum      | TEXT       | Коды ценных бумаг           |
|      | exec_date   | TEXT       | Даты погашения ценных бумаг |

### Описание модульной структуры
Приложение включает в себя 1 главное окно и 7 диалоговых окон:
- MainForm.ui – Главное окно для визуализация данных и взаимодействие с ними;

- DeleteDialog.ui – Диалоговое окно для подтверждения удаления;

- ErrorDialog.ui – Диалоговое окно для сообщения о том, что запись для редактирования не выбрана;

- EditDialog.ui – Диалоговое окно для редактирования записей;

- AddDialog1.ui – Диалоговое окно для добавления записей в таблицу Activ;

- AddDialog2.ui –  Диалоговое окно для добавления записей в таблицу Act_isp;

- AnalysisDialog.ui – Диалоговое окно для реализации расчета статических характеристик и занесения их в документ;

- Calendar.ui – Диалговое окно для выбора даты из календаря.

## Документация информационной системы
### Краткое описание и назначение системы
«Управление биржевыми операциями с ценными бумагами» - это программный проект, предоставляющий всю информацию по ценным бумагам. Программа ориентирована на пользователя, поэтому позволяет оперативно производить различные манипуляции с данными (удаление, добавление, редактирование, фильтрация). Также по этим данных предусмотрен расчет статистических характеристик и последующее формирование документов.

### Руководство пользователя
Удалить можно одну или несколько записей. Для этого достаточно нажать на номер той записи, которую требуется удалить. После нажатия на кнопку удаления необходимо подтвердить выбор, нажав на кнопку «Да».

![image_3_2_1](image/image_3_2_1.png)  
*Рис.3.2.1. Диалоговое окно «Внимание»*

Окно редактирования имеет 4 заполненных поля, из которых дата торгов и код бумаги не доступны для редактирования. Чтобы осуществить редактирование необходимо внести изменения в текущие значения цены и доходности, затем нажать на кнопку «Ок». Если введенные значения не соответствуют требованиям, то на дисплее будет выведено соответствующее сообщение об ошибке.

![image_3_2_2](image/image_3_2_2.png)  
*Рис.3.2.2. Диалоговое окно «Редактирование»*

Окно добавление новой записи в таблицу Activ имеет 4 поля. Дата торгов выбирается из календаря. Переход в окно календаря осуществляется после нажатия на кнопку «Выбрать дату». Код бумаги выбирается из выпадающего списка, который состоит из всех кодов, содержащихся в таблице act_isp. Значения цены и доходности вводятся вручную. Если введенные значения не соответствуют требованиям, то на дисплее будет выведено соответствующее сообщение об ошибке.

![image_3_2_3](image/image_3_2_3.png)  
*Рис.3.2.3. Диалоговое окно «Добавление новой записи в Activ»*

Окно добавления новой записи в таблицу Act_isp имеет 2 поля. Дата погашения выбирается из календаря. Переход в окно календаря осуществляется после нажатия на кнопку «Выбрать дату». Код бумаги требует ввода только числовых значений, поскольку маска вводится автоматически. Если введенная комбинация значений не соответствуют требованиям, то на дисплее будет выведено соответствующее сообщение об ошибке.

![image_3_2_4](image/image_3_2_4.png)  
*Рис.3.2.4. Диалоговое окно «Добавление новой записи в Act_isp»*

Окно анализа статистических характеристик имеет 2 поля для ввода начала и конца календарной предыстории. Даты выбираются из календаря. Переход на окно календаря осуществляется после нажатия на одну из кнопок «Выбрать дату» в зависимости от того, какую дату требуется выбрать. Если введенные значения не соответствуют требованиям, то на дисплее будет выведено соответствующее сообщение об ошибке. Если ввод произведен корректно, то после нажатия на кнопку «Рассчитать» в таблице, которая содержит 6 столбцов, появятся рассчитанные значения характеристик. Кнопка «Очистить» позволяет стереть выведенные значения. При нажатии на кнопку «Сохранить» происходит создание документа с именем doc2.docx и занесение туда текущих данных таблицы.

![image_3_2_5](image/image_3_2_5.png)  
*Рис.3.2.5. Диалоговое окно «Анализ статистических характеристик»*

В окне календаря представлен один месяц. Для того, чтобы переключиться на другой, необходимо нажать на одну из стрелок, а после выбора числа, нажать на кнопку «Подтвердить»

![image_3_2_6](image/image_3_2_6.png)  
*Рис.3.2.6. Диалоговое окно «Календарь»*

Фильтрация производится по таблице Activ. В один или несколько подзаголовков (Дата торгов, код бумаги, цена, доходность) вводятся значения, по которым требует отфильтровать исходную таблицу. Если введенная комбинация значений не соответствуют требованиям, то на дисплее будет выведено соответствующее сообщение об ошибке. После нажатия на кнопку «Применить фильтр» на месте исходной таблицы появляется отфильтрованная таблица. Вернуться к исходному состоянию можно нажав на кнопку «Сбросить фильтр»

![image_3_2_7](image/image_3_2_7.png)  
*Рис.3.2.7. Блок «Фильтрация» главного окна*

### Руководство администратора
Минимальные системные требования:
- Windows 7+
- 30 Мб свободного места на диске  

Для работы программы необходимо скачать и распаковать архив Exchange.rar в папку на своем компьютере. Далее найти и запустить файл Exchange.exe.

## Результаты испытаний системы

-  **Проверка возможности переключения между таблицами**

    На рисунке 4.1. видно, что таблица Activ доступна для просмотра

    ![image_4_1](image/image_4_1.png)  
    *Рис.4.1. Главное окно с таблицей Activ*

    На рисунке 4.2. видно, что таблица Act_isp доступна для просмотра

    ![image_4_2](image/image_4_2.png)  
    *Рис.4.2. Главное окно с таблицей Act_isp*

- **Проверка возможности редактирования данных**

    Выберем запись, в качестве той, на которой будут проводиться дальнейшие тестирования

    ![image_4_3](image/image_4_3.png)  
    *Рис.4.3. Выбранная запись до редактирования*

    Введем новые значения для текущей цены и текущей доходности и нажмем на кнопку «Ок». 

    ![image_4_4](image/image_4_4.png)  
    *Рис.4.4. Окно «Редактирование записи»*

    Из рисунка 4.5. видно, что первая запись была успешна отредактирована

    ![image_4_5](image/image_4_5.png)  
    *Рис.4.5. Выбранная запись после редактирования*  

- **Проверка возможности добавление записи в таблицу Activ**

    Выберем дату торгов из календаря и введем значения для текущей цены и текущей доходности, затем нажмем на кнопку «Ок»

    ![image_4_6](image/image_4_6.png)  
    *Рис.4.6. Окно «Добавление записи в Activ»*

    Из рисунка 4.7. видно, что запись была успешно добавлена (30 запись)

    ![image_4_7](image/image_4_7.png)  
    *Рис.4.7. Добавленная запись*

- **Проверка возможности добавление записи в таблицу act_isp**

    Введем код бумаги и выберем дату погашения из календаря, затем нажмем на кнопку «Ок»

    ![image_4_8](image/image_4_8.png)  
    *Рис.4.8. Окно «Добавление записи в Act_isp»*

    Из рисунка 4.9. видно, что запись была успешно добавлена (55 запись)

    ![image_4_9](image/image_4_9.png)  
    *Рис.4.9. Добавленная запись*

- **Проверка возможности удаления данных**

    Выберем запись для удаления и нажмем на нее. После чего нажмем на кнопку «Удалить запись» и подтвердим удаление.

    ![image_4_10](image/image_4_10.png)  
    *Рис.4.10. Выбранная запись для удаления*

    Из рисунка 4.11. видно, что запись была успешна удалена

    ![image_4_11](image/image_4_11.png)  
    *Рис.4.11. Запись после удаления*

- **Проверка возможности фильтрации**

    Заполним значениями все поля и нажмем на кнопку «Применить фильтр»

    ![image_4_12](image/image_4_12.png)  
    *Рис.4.12. Главное окно после фильтрации по всем полям*

    Таблица, отфильтрованная по всем заданным значениям, имеет 4 записи

- **Формирование документов по таблице главного окна**

    После успешной фильтрации нажмем на кнопку «Сохранить». После этого в каталоге с программой будет создан документ с именем doc1.docx, в которой представлены данные главного окна.

    ![image_4_13](image/image_4_13.png)  
    *Рис.4.13. Документ doc1.docx*

    Документ содержит примененные фильтры и таблицу данных, с учетом этих фильтров.

- **Проверка возможности расчета статистических характеристик и формирование документа**

    Выберем дату начала и конца календарной предыстории и нажмем на кнопку «Рассчитать»

    ![image_4_14](image/image_4_14.png)  
    *Рис.4.14. Окно «Анализ статистических характеристик»*

    Таблица содержит 33 бумаги, продававшиеся 26.09.1996. 
    После успешного расчета нажмем на кнопку «Сохранить».  После этого в каталоге с программой будет создан документ с именем doc2.docx, в которой представлены рассчитанные статистические характеристики, изменение среднего и дисперсии и размах.

    ![image_4_15](image/image_4_15.png)  
    *Рис.4.15. Документ doc2.docx*

    Документ содержит календарную предысторию и таблицу анализа с рассчитанными значениями.

## Заключение
В результате выполнения цикла взаимосвязанных лабораторных работ был разработан проект «Управление биржевыми операциями с ценными бумагами», позволяющий накапливать и анализировать данные торгов активами срочного рынка. 

В программе реализовано выполнение следующих операций: удаление, редактирование, добавление и фильтрация данных; расчет по этим данных основного контролируемого показателя и статистических характеристик; определение тенденции изменения среднего и дисперсии; документирование результатов обработки данных.

## Список используемых источников
1.	Руководство по Qt Designer, URL: https://doc.qt.io/qt-6/qtdesigner-manual.html
2.	Документация Qt для Python, URL: https://doc.qt.io/qtforpython/
3.	Документация Python 3.11.0, URL: https://docs.python.org/3/
